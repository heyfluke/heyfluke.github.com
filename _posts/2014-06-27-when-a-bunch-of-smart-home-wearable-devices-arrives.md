---
layout: post
title: "当一大波智能硬件正在来临"
description: ""
category: 
tags: []
date: 2014-06-27 15:48:21 +0800
---
{% include JB/setup %}

#引子

近几年来，”物联网“、”智能家居"、“可穿戴设备”这些名词已经逐渐被大家熟悉，变得不是那么新潮了。然而智能硬件真正要走入人们的生活的时候，又不免觉得幸福来的有点突然。在此，我想看下市面上的智能硬件都是怎么玩的。

# 开放软件API

##  智能硬件的雏形

我家里有一个比较老式的报警器，它的主要功能是通过无线连接周边的传感器，一旦传感器被触发，警笛就会响起，于此同时，它还会马上通过拨打电话和发送短信的方式通知我。而远在办公室的我，则可以通过手机拨打电话或者发送短信的方式来对报警器进行操作，例如关闭某个传感器，另外还可以开关他内置的继电器以达到开关热水器、电饭煲的功能。

这个报警器是一个比较原始的“智能”硬件，因为我可以在手机上面得到它的反馈，并且可以控制它。但是我却几乎没法对它进行编程，例如让某个传感器来触发继电器打开空调--厂家并没有开放API。当然，由于我知道他的操作方式里有一种是短信操作，所以我能在Android手机上开发一个软件，在接收到报警短信的时候给它回复一条短信让他打开继电器。

## 可编程的硬件

我接触过另外3个有意思的硬件，他们分别是脑立方(NeuroSky MindWave)、Jawbone Up以及飞利浦Hue。它们在各自的领域都比较有代表性。

脑立方是一款脑波检测硬件，通过它，使用者可以用自己的意念来玩一些游戏，例如控制某个小球往目标走去。严格来说，这款神奇的硬件并不能达到双向交互，它只是提供穿戴者的脑波数据给开发者，开发者通过其开发套件(MDT)可以实现一些用意念控制的游戏。

JawBone Up的名气要比脑立方大得多了，他的受众和使用场景更加广泛，这是一个能检测人体各种参数（脉搏、睡眠、运动量）的手环，穿戴者不但可以通过官方的App得到这些数据，还能使用第三方的App来获取饮食建议、计划运动、设置震动闹钟、分享到社区等。

Hue是飞利浦推出的一款可调节的灯泡，应该算得上是互联网上面最知名的智能家居产品之一。现在它也有了开发者平台，结合脑立方来反应你意念的颜色怎么样？

类似的硬件还有很多，都有自己的API可供玩耍，不过每一款产品或者说每一家厂商的产品都相对单一，同类型产品的API的能力也不尽一样。

# 开放平台的玩法

就在今年刚刚结束的Apple WWDC以及Google IO大会上，这两家公司几乎同时推出健康平台Healthkit以及Google Fit，其中Apple还推出了HomeKit用于管理智能家居。而在更早的时候另一巨头--拥有多款智能手表的三星就已经发布了SAMI--这是一个更加纯粹的物联网平台(与此类似的还有国内的yeelink，他们开始得更早)。

Apple和Google正在用统一的行动以及携手众多智能硬件厂商来告诉我们，可穿戴智能硬件的春天来了，看下各家的合作伙伴：

Apple Healthkit/HomeKit: Nike, Fitbit, Wahoo Fitness, iHealth, Withings, Broadcom, 海尔, Marvell ..
Google Fit: Nike+, LF, Adidas, Basis, RunKeeper, Polar, HTC, Motorola, LG, Withings ..

这两个开放平台的核心价值是把数据标准化、集中管理起来，在这个基础上，开发者可以方便地利用这些数据进行创造。下面就以Apple刚发布的HealthKit为例，看下它是如何使得硬件厂商和软件开发者的利益最大化，如何利用这个平台产生无限的想象。

目前App Store上有大量出色的健康类应用，但他们很少能互相共享数据，并且只支持特性类型的硬件或者数据，正如前面说列举的一些硬件那样互相不兼容。而Apple发布HealthKit就要着重解决这些问题。

* 抽取健康类数据共性
  * HKUnit 灵活地定义数据单位，轻松定义克(g)、克每十分之一升(g/dL)等
  * HKQuantity 单位换算以及可转换性检测
  * HKObjectType 单位分类，归类各种数据所用的分类，例如表示睡眠和血压就用不同类型的单位
  * 能够存储数据采样、枚举等的类型。例如表示脉搏是一段时间的采样，表示体重是一瞬间的采样。
  * 自定义元数据，可以用来存储采样地点、硬件信息等。
* 数据存取
  * HKHealthStore 存取数据
  * Characteristics 指定取出的数据类型，例如血型、性别……
  * HKQuery 查询数据，筛选关心的数据、顺序等
  * HKObserverQuery 数据变化触发器，实时监控自己的身体
  * HKAnchoredObjectQuery 类似数据库的cursor，记录查询位置
* 数据统计
  * HKStatistics 求和、取最大、最小、平均值等
  * 数据分类：离散数据、累计数据
  * 区分数据源
  * HKStatisticsQueryCollection 设定间隔产生多个统计值，用来画统计图
* 安全
  * HealthStore 在使用的时候需要请求授权
  * capability 列表
  * Per object type 权限控制，包括读写也可以单独控制
* 本地化
* 共享
  
可见，HealthKit其实就是一个前所未见的能提供非常丰富的数据类型的“设备”，软件开发者可以不在局限于某一款硬件或者少量几种类型的身体数据来开发自己的应用，在不需要支持更多API的基础上通过组合更多类型的健康硬件来收集更多健康数据。对于个人消费者来说，他们也终于有机会系统地管理自己的身体数据。这确实是一个进步。

而在硬件方面，可以通过外设几种外设接口来接入硬件到iPhone：

* 蓝牙BLE和经典蓝牙
* WiFi
* Lightning/USB/Thunderbolt2/耳机等接口 (部分接口只有在OS X设备才有，HealthKit外设在iPhone主要是用蓝牙)

总的来说接口比较丰富，有完善的文档，限制方面可能需要注意的是MFi计划，并不是所有硬件都能随便接入Apple的生态内。

硬件外设在作为HealthKit外设接入Apple生态的时候和去接入Windows不太一样的地方主要是有HealthKit这个Framework要去适配。HealthKit内建了对如下外设的支持（HealthKit对于常见的几类外设都要求在蓝牙可选字段上表示一些元数据以供识别）：

* 心跳监视器
* 血糖传感器
* 血压监视器
* 体温计

这意味着这些外设不但不需要编写iPhone上面的驱动程序，连软件都不需要，HealthKit直接就能使用这些外设。而其他一些个性化的设备也只需要遵照BLE的标准来开发也被允许接入到Apple的生态圈内，这无疑丰富了生态圈内可以使用的健康数据类型。

Apple可以说是目前从建立“生态圈”受益最大的一间科技公司（虽然iPhone发布之初是非常封闭的），但支撑他们走了这么远的原因除了他们自己精心打理这个生态圈以外，更加重要的是它实实在在地为广大的开发者带来了丰厚的收入。有理由相信HealthKit和HomeKit的生态能走得很远。

# 自由无界的物联网

什么是自由无界的物联网？

想象一下，当我想查看我的邮件包裹到什么地方了，只要在浏览器上面访问things://mything-name/where-are-you或者发一封邮件到mything-name@thins-interner.com就能看到根据他发回来的经纬度展示的地图。当物流人员去仓库取件的时候，他手上的取件仪器靠近我的包裹的时候，立刻收到并且显示包裹发过来的信息“hi,我是包裹mything-name”……

在物联网（internet of things）环境下，接入网络的物体可以被“寻址”--即通过特定的地址可以和它通信，物体之间有一种“语言”，这种语言看起来可能比较死板形如：

```
{
	'message-version':1.0,
	'sender-info':{
		'capabilities': {
			'display':{'resolution':'1920x1080','pixel-format':'RGB'},
			'speaker':{'max-volume':'100dB'},
			...
		},
		'unified-name':'general-television-device-UUID-...',
		'things-address':'...',
		...
	},
	'message':{'type':'query-info', 'target':'thing-address-xxx'}
}
```

这个场景很像我们往月球发一条消息：“月球月球，帮我发一条消息到阿尔法0001：我们是地球，我们这里有绿色植物能产生氧气，请问提供一下你们的介绍……”

相比这种没有边界的物联网，HealthKit们只是一个子集，后者没有复杂的寻址需求（HomeKit的寻址比HealKit复杂一些），通信语言也相对精确、不需要太多啰嗦的内容，甚至物与物之间都不需要交流，最多只需要同HealthKit这个大管家去要一些数据，更多的情况下是供人去查询数据而已。

是的，HealthKit这种非常具体化的的平台对我们来说实际意义更加大，在精心管理之下，能产生合理的经济价值。那就先把太理想化的物联网先放一边，来看一下介于纯粹物联网和垂直领域智能设备平台之间的平台。

# 传感器网络

传感器网络也是一个平台，在这个平台上也有一个类似HealthKit的分界线，一边是硬件、传感器截图进来，另外一边是人们用软件来利用起这些数据和功能。

目前国内做的最成熟的恐怕是[yeelink](http://www.yeelink.net)，在上面可以卡到全国各地截图的各种设备--摄像头、环境传感器、GPS、家电开关……甚至网络上的软件也能成为触发器--例如微博（这里顺便提一下著名的“触发器”网站[IFTTT](http://www.ifttt.com)，你可以利用他来关联各种事件，例如当收到某Email的时候发送短信给某人）。开发者在这个平台上面可以方便地对这些设备进行寻址和通信，例如我可以在阳台上安装一些湿度、温度、声音、光线等传感器，把这些传感器以及家里的其他设备都通过[Arduino](http://www.arduino.cc)单片机来控制，然后写段程序来根据传感器的数据来控制家里的电器来调节温度和光线。当然，也可以通过平台来获取开放性的数据。

# 展望

物联网技术还有很多具体的实现，例如我们在室内可以通过RCU来进行房间内的安防、电器等进行控制，不一而足。不过我相信今年在垂直领域可穿戴设备以及智能家居平台由互联网和消费巨头来争相领头发展的情况下，一定会对整个行业产生深远的影响。

对于具体的某个厂商来说，是进入这些生态，还是自立门户，和自身的具体情况有关。对于一些小厂商，似乎接入到生态圈里面是一个比较快的获取用户的办法，也能够迅速利用现有资源而成长起来。对于移动互联网入口级别的厂商例如小米，则肯定优先考虑自立门户了。在行业变革的喧嚣之下，受益最大的还是咱们消费者，生在这个年代，幸福。





















                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                        
  

